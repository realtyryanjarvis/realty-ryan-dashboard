<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>RRA Command Center</title>
<meta name="description" content="Realty Ryan & Associates Command Center">
<meta name="theme-color" content="#7A3B14">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="assets/icon-192.png">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&family=Work+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>

<!-- LOGIN -->
<div id="login-screen" class="login-screen">
  <div class="login-card">
    <div class="login-logo">
      <div class="logo-mark">RRA</div>
      <h1>Command Center</h1>
      <p class="login-subtitle">Realty Ryan & Associates</p>
    </div>
    <form id="login-form" autocomplete="off">
      <div class="input-group">
        <label for="login-email">Email</label>
        <input type="email" id="login-email" placeholder="you@realtyryan.com" required>
      </div>
      <div class="input-group">
        <label for="login-password">Password</label>
        <input type="password" id="login-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
      </div>
      <div id="login-error" class="login-error"></div>
      <button type="submit" class="btn-primary btn-full">Sign In</button>
    </form>
  </div>
  <div class="login-footer">Corcoran HM Properties</div>
</div>

<!-- APP SHELL -->
<div id="app-shell" class="app-shell hidden">
  <!-- SIDEBAR -->
  <nav id="sidebar" class="sidebar">
    <div class="sidebar-header">
      <div class="sidebar-logo">RRA</div>
      <span class="sidebar-title">Command Center</span>
      <button class="sidebar-close" id="sidebar-close">√ó</button>
    </div>
    <ul class="nav-list">
      <li class="nav-item active" data-view="dashboard"><span class="nav-icon">‚óé</span> Dashboard</li>
      <li class="nav-item" data-view="listings"><span class="nav-icon">‚åÇ</span> Listings Pipeline</li>
      <li class="nav-item" data-view="buyers"><span class="nav-icon">‚óà</span> Buyers Pipeline</li>
      <li class="nav-item" data-view="contacts"><span class="nav-icon">‚óâ</span> Contacts</li>
      <li class="nav-item" data-view="appointments"><span class="nav-icon">‚ñ£</span> Appointments</li>
      <li class="nav-item" data-view="calendar"><span class="nav-icon">üìÖ</span> Calendar</li>
      <li class="nav-item" data-view="activity"><span class="nav-icon">‚ö°</span> Activity</li>
      <li class="nav-item" data-view="reports"><span class="nav-icon">üìä</span> Reports</li>
      <li class="nav-divider"></li>
      <li class="nav-item" data-view="tasks"><span class="nav-icon">‚òê</span> Tasks</li>
      <li class="nav-item" data-view="financials"><span class="nav-icon">‚óÜ</span> Financials</li>
      <li class="nav-item" data-view="showings"><span class="nav-icon">‚óê</span> Showings</li>
      <li class="nav-item" data-view="vendors"><span class="nav-icon">‚óß</span> Vendors</li>
      <li class="nav-divider"></li>
      <li class="nav-item" data-view="settings"><span class="nav-icon">‚öô</span> Settings</li>
    </ul>
    <div class="sidebar-footer">
      <div class="user-badge">
        <div class="user-avatar" id="sidebar-avatar">RP</div>
        <div class="user-info">
          <span class="user-name" id="sidebar-name">Ryan Palmer</span>
          <span class="user-role" id="sidebar-role">Agent Lead</span>
        </div>
      </div>
    </div>
  </nav>

  <!-- MAIN -->
  <main class="main-content">
    <header class="topbar">
      <div class="topbar-left">
        <button class="hamburger" id="hamburger">‚ò∞</button>
        <div class="search-box">
          <input type="text" placeholder="Search transactions, contacts..." id="global-search">
        </div>
      </div>
      <div class="topbar-right">
        <button class="notif-bell" id="notif-bell" aria-label="Notifications">
          <span class="bell-icon">üîî</span>
          <span class="notif-count hidden" id="notif-count">0</span>
        </button>
        <div class="notif-panel hidden" id="notif-panel">
          <div class="notif-panel-header">
            <h4>Notifications</h4>
            <button class="btn-link" id="notif-mark-all-read">Mark all read</button>
          </div>
          <div class="notif-panel-list" id="notif-panel-list">
            <p class="empty-msg">No notifications</p>
          </div>
        </div>
        <div class="topbar-user">
          <span class="topbar-user-name" id="topbar-name">Ryan Palmer</span>
          <div class="topbar-avatar" id="topbar-avatar">RP</div>
        </div>
        <button class="btn-signout" id="btn-signout" title="Sign Out">‚Üó</button>
      </div>
    </header>

    <div class="view-container" id="view-container">

      <!-- DASHBOARD -->
      <section id="view-dashboard" class="view active">
        <div class="view-header">
          <h2>Dashboard</h2>
          <p class="view-subtitle" id="dashboard-date"></p>
        </div>
        <div class="stats-grid" id="dashboard-stats"></div>
        <div class="dashboard-panels">
          <div class="panel">
            <h3>Upcoming Tasks</h3>
            <div class="task-list" id="dashboard-tasks"></div>
          </div>
          <div class="panel">
            <h3>Recent Activity</h3>
            <div class="activity-feed" id="dashboard-activity"></div>
          </div>
        </div>
        <div class="panel" style="margin-top:20px">
          <div class="panel-header-row">
            <h3>üìÖ Upcoming Calendar Events</h3>
            <button class="btn-link" onclick="navigateTo('calendar')">View Full Calendar ‚Üí</button>
          </div>
          <div id="dashboard-calendar-events" class="calendar-event-list"></div>
        </div>
      </section>

      <!-- LISTINGS PIPELINE -->
      <section id="view-listings" class="view">
        <div class="view-header">
          <h2>Listings Pipeline</h2>
          <button class="btn-primary btn-sm" id="btn-new-listing">+ New Listing</button>
        </div>
        <div class="pipeline-board" id="listing-pipeline"></div>
      </section>

      <!-- BUYERS PIPELINE -->
      <section id="view-buyers" class="view">
        <div class="view-header">
          <h2>Buyers Pipeline</h2>
          <button class="btn-primary btn-sm" id="btn-new-buyer">+ New Buyer</button>
        </div>
        <div class="pipeline-board" id="buyer-pipeline"></div>
      </section>

      <!-- CONTACTS -->
      <section id="view-contacts" class="view">
        <div class="view-header">
          <h2>Contacts</h2>
          <div class="view-actions">
            <button class="btn-primary btn-sm" id="btn-new-contact">+ New Contact</button>
          </div>
        </div>
        <div class="filter-bar" id="contacts-filters">
          <input type="text" class="filter-search" id="contacts-search" placeholder="Search contacts...">
          <select class="filter-select" id="contacts-type-filter">
            <option value="">All Types</option>
            <option value="buyer">Buyers</option>
            <option value="seller">Sellers</option>
            <option value="both">Both</option>
            <option value="vendor">Vendors</option>
            <option value="agent">Agents</option>
            <option value="other">Other</option>
          </select>
          <select class="filter-select" id="contacts-status-filter">
            <option value="">All Statuses</option>
            <option value="lead">Lead</option>
            <option value="active">Active</option>
            <option value="under-contract">Under Contract</option>
            <option value="closed">Closed</option>
            <option value="archived">Archived</option>
          </select>
        </div>
        <div class="data-table-wrap">
          <table class="data-table" id="contacts-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Status</th>
                <th>Phone</th>
                <th>Email</th>
                <th>Source</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="contacts-tbody"></tbody>
          </table>
        </div>
        <div class="empty-state hidden" id="contacts-empty">
          <p>No contacts yet. Add your first contact to get started.</p>
        </div>
      </section>

      <!-- APPOINTMENTS -->
      <section id="view-appointments" class="view">
        <div class="view-header">
          <h2>Listing Appointments</h2>
          <button class="btn-primary btn-sm" id="btn-new-appt">+ New Appointment</button>
        </div>
        <div id="appointments-list" class="appointments-list"></div>
      </section>

      <!-- CALENDAR -->
      <section id="view-calendar" class="view">
        <div class="view-header">
          <h2>Calendar</h2>
          <div class="view-actions">
            <button class="btn-outline btn-sm" id="cal-prev">‚Äπ</button>
            <span class="cal-month-label" id="cal-month-label"></span>
            <button class="btn-outline btn-sm" id="cal-next">‚Ä∫</button>
            <button class="btn-outline btn-sm" id="cal-today">Today</button>
            <select class="filter-select" id="cal-view-mode">
              <option value="month">Month</option>
              <option value="week">Week</option>
              <option value="list">List</option>
            </select>
            <button class="btn-primary btn-sm" id="btn-new-cal-event">+ Event</button>
          </div>
        </div>
        <div class="cal-legend" id="cal-legend">
          <span class="cal-leg-item"><span class="cal-dot" style="background:#a0342e"></span> DD Deadline</span>
          <span class="cal-leg-item"><span class="cal-dot" style="background:#2d6a4f"></span> Closing</span>
          <span class="cal-leg-item"><span class="cal-dot" style="background:#3a6ea5"></span> Inspection</span>
          <span class="cal-leg-item"><span class="cal-dot" style="background:#6b4c9a"></span> Appraisal</span>
          <span class="cal-leg-item"><span class="cal-dot" style="background:#b8860b"></span> Appointment</span>
          <span class="cal-leg-item"><span class="cal-dot" style="background:#9a9590"></span> Other</span>
        </div>
        <div id="calendar-grid" class="calendar-grid"></div>
        <div id="calendar-list" class="calendar-list hidden"></div>
      </section>

      <!-- TASKS -->
      <section id="view-tasks" class="view">
        <div class="view-header">
          <h2>Tasks</h2>
          <div class="view-actions">
            <select class="filter-select" id="tasks-filter-assignee">
              <option value="">All</option>
              <option value="ryan-001">Ryan</option>
              <option value="ally-001">Ally</option>
            </select>
            <button class="btn-primary btn-sm" id="btn-new-task">+ New Task</button>
          </div>
        </div>
        <div id="tasks-sections"></div>
      </section>

      <!-- FINANCIALS -->
      <section id="view-financials" class="view">
        <div class="view-header">
          <h2>Financials</h2>
          <div class="view-actions">
            <select class="filter-select" id="fin-period">
              <option value="month">This Month</option>
              <option value="quarter">This Quarter</option>
              <option value="year">This Year</option>
              <option value="all">All Time</option>
            </select>
          </div>
        </div>
        <div class="stats-grid" id="fin-stats"></div>
        <div class="panel" style="margin-top:20px">
          <h3>Per-Deal Breakdown</h3>
          <div class="data-table-wrap">
            <table class="data-table" id="fin-deals-table">
              <thead><tr><th>Deal</th><th>GCI</th><th>Expenses</th><th>Net</th><th>Status</th></tr></thead>
              <tbody id="fin-deals-tbody"></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- SHOWINGS -->
      <section id="view-showings" class="view">
        <div class="view-header">
          <h2>Showings</h2>
          <button class="btn-primary btn-sm" id="btn-add-showing">+ Add Showing</button>
        </div>
        <div id="showings-summary" class="stats-grid"></div>
        <div id="showings-by-listing" style="margin-top:20px"></div>
      </section>

      <!-- VENDORS -->
      <section id="view-vendors" class="view">
        <div class="view-header">
          <h2>Vendor Directory</h2>
          <button class="btn-primary btn-sm" id="btn-new-vendor">+ Add Vendor</button>
        </div>
        <div class="filter-bar">
          <input type="text" class="filter-search" id="vendors-search" placeholder="Search vendors...">
          <select class="filter-select" id="vendors-cat-filter">
            <option value="">All Categories</option>
            <option value="photographer">Photographer</option>
            <option value="videographer">Videographer</option>
            <option value="inspector">Inspector</option>
            <option value="attorney">Attorney</option>
            <option value="lender">Lender</option>
            <option value="contractor">Contractor</option>
            <option value="stager">Stager</option>
            <option value="other">Other</option>
          </select>
        </div>
        <div id="vendors-grid" class="vendors-grid"></div>
      </section>

      <!-- ACTIVITY -->
      <section id="view-activity" class="view">
        <div class="view-header">
          <h2>Activity</h2>
          <div class="view-actions">
            <input type="date" id="activity-date" class="form-input">
          </div>
        </div>
        <div id="activity-feed-full" class="activity-feed-full"></div>
      </section>

      <!-- REPORTS -->
      <section id="view-reports" class="view">
        <div class="view-header">
          <h2>Reports</h2>
          <div class="view-actions">
            <input type="date" id="report-start" class="form-input">
            <span style="color:var(--muted);line-height:36px">to</span>
            <input type="date" id="report-end" class="form-input">
            <button class="btn-outline btn-sm" id="btn-run-report">Generate</button>
          </div>
        </div>
        <div class="stats-grid" id="report-stats"></div>
        <div class="report-charts">
          <div class="panel"><h3>Monthly Production</h3><canvas id="chart-production"></canvas></div>
          <div class="panel"><h3>Conversion Funnel</h3><canvas id="chart-funnel"></canvas></div>
        </div>
        <div class="report-charts" style="margin-top:20px">
          <div class="panel"><h3>Avg Days on Market</h3><canvas id="chart-dom"></canvas></div>
          <div class="panel"><h3>Agent Performance</h3><canvas id="chart-agents"></canvas></div>
        </div>
      </section>

      <!-- SETTINGS -->
      <section id="view-settings" class="view">
        <div class="view-header"><h2>Settings</h2></div>
        <div class="panel">
          <h3>Account</h3>
          <div class="settings-section" id="settings-account"></div>
        </div>
        <div class="panel" style="margin-top:20px">
          <h3>üîî Notifications</h3>
          <p class="view-subtitle" style="margin-bottom:16px">Toggle which notification types you receive.</p>
          <div class="settings-section" id="settings-notifications">
            <label class="toggle-row"><input type="checkbox" data-notif-type="stage-change" checked><span>Deal stage changes</span></label>
            <label class="toggle-row"><input type="checkbox" data-notif-type="doc-uploaded" checked><span>Documents uploaded/signed</span></label>
            <label class="toggle-row"><input type="checkbox" data-notif-type="deadline-approaching" checked><span>Deadlines approaching</span></label>
            <label class="toggle-row"><input type="checkbox" data-notif-type="task-assigned" checked><span>New tasks assigned</span></label>
            <label class="toggle-row"><input type="checkbox" data-notif-type="contact-added" checked><span>New contacts added</span></label>
            <label class="toggle-row"><input type="checkbox" data-notif-type="showing" checked><span>Showings scheduled/completed</span></label>
            <label class="toggle-row"><input type="checkbox" data-notif-type="sound" checked><span>üîä Notification sound</span></label>
          </div>
        </div>
      </section>

    </div>
  </main>
</div>

<!-- MODAL CONTAINER -->
<div id="modal-overlay" class="modal-overlay hidden">
  <div class="modal-content" id="modal-content"></div>
</div>

<!-- TOAST -->
<div id="toast-container" class="toast-container"></div>

<audio id="notif-sound" preload="auto" src="data:audio/wav;base64,UklGRlQFAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YTAFAAAAAAAtAFoAhACmAL8AzwDWANQAyQC2AJ0AfgBaADMADADo/8P/ov+F/27/Xf9T/1D/Vf9h/3P/jP+q/8z/8P8TADUAVABuAIIAjwCTAI8AhAByAFoAPQAbAPj/0v+s/4j/Z/9L/zb/Kf8k/yf/Mv9F/1//f/+k/8z/9f8dAEMAZACAAJQAoACjAJwAjAByAFAAJwD4/8b/kv9f/zD/CP/o/tH+xP7C/sv+3/7+/ib/Uf+B/7P/5P8TAD4AYgB+AI8AlgCRAIIAaQBGABwA7v+8/4n/WP8r/wT/5v7T/sv+z/7f/vv+JP9T/4j/v//4/y8AZACRAJ4ApgCkAJcAgABfADQAAgDK/5D/Vv8i//b+2f7K/sn+1v7x/hX/Qv92/63/5v8cAFAAewCcALIAuwC5AKoAkABrADwABgDM/5D/V/8k//3+5v7d/uP+9/4Z/0T/d/+u/+j/IQBXAIYArADFANIA0gDIALIAkgBoADUA/P/A/4X/UP8k/wT/8v7v/vr+E/82/2L/lP/I//3/MABgAIkAqAC8AMQAwgC0AJwAegBNABgA4P+m/3D/Qf8a/wD/9P71/gT/Hf8+/2b/k//D//P/IgBNAHIAjgCgAKgAowCTAHgAUwAkAPL/vf+K/1z/NP8W/wX/A/8L/x3/N/9Y/37/pv/R//z/JQBJAGcAfACJAIoAgABuAFIAMAAN/+j/w/+i/4b/cf9i/1z/Xv9n/3j/j/+s/8v/6/8MACoAQwBUAF8AZQBYAEYALQAQ//H/0/+4/6H/kP+G/4L/hv+R/6L/t//R/+z/BwAhADkASgBWAFwAWABKADkAIQAI/+7/1f+//67/o/+e/5//p/+1/8b/3P/0/wwAIwA3AEYAUABUAE4AQgAyAB0ABv/v/9n/xf+2/6z/p/+o/67/uf/I/9n/7P8AABIAIwAyADoAPgA8ADQAKAAZAAYA8v/i/9X/yv/E/8L/xP/L/9T/4P/t//z/CgAXACIAKQAtAC0AKAAhABcACwD+//L/6P/g/9v/2P/Y/9v/4f/p//H/+v8DAAoAEQAVABgAFwATAA0ABgD//w=="></audio>
<script src="app.js"></script>
<script>if('serviceWorker' in navigator){navigator.serviceWorker.register('sw.js');}</script>
</body>
</html>
